<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡¶≤‡ßã‡¶°‡¶∂‡ßá‡¶°‡¶ø‡¶Ç ‡¶∞‡¶ø‡¶ï‡¶≠‡¶æ‡¶∞‡¶ø - Ultra Advanced</title>
<style>
  /* Basic reset */
  * {margin:0;padding:0;box-sizing:border-box;font-family:sans-serif;}
  body,html{width:100%;height:100%;overflow:hidden;background:#071126;}
  button{cursor:pointer;transition:0.2s;}
  .hidden{display:none;}
  /* Flashlight overlay */
  #flash{position:absolute;inset:0;pointer-events:auto;background:radial-gradient(circle 160px at 50% 50%, rgba(255,255,230,0.95), rgba(0,0,0,0) 40%), radial-gradient(circle 360px at 50% 50%, rgba(255,255,255,0.04), rgba(0,0,0,0.92) 60%);}
  /* Particle canvas */
  canvas{position:absolute;inset:0;pointer-events:none;}
  /* Overlay */
  #overlay{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.7);z-index:1000;}
  #overlayContent{background:linear-gradient(to bottom,#00131a,#001b22);padding:20px;border-radius:15px;text-align:center;border:2px solid #0ff;}
  /* Hint */
  #hint{position:absolute;bottom:20px;left:50%;transform:translateX(-50%);background:rgba(0,0,0,0.5);padding:8px 16px;border-radius:999px;border:1px solid #0ff;color:#0ff;font-size:14px;z-index:50;}
  /* HUD left panel */
  #hud{position:absolute;top:0;left:0;width:200px;height:100%;background:rgba(255,255,255,0.02);padding:10px;border-right:1px solid #0ff;color:#0ff;z-index:20;}
  #hud div{margin-bottom:10px;}
  /* Button styles */
  .btn{padding:5px 10px;border-radius:5px;border:none;background:#0ff;color:#000;font-weight:bold;}
  .btn-small{padding:3px 6px;font-size:12px;}
  /* Targets */
  .target{position:absolute;background-size:contain;background-repeat:no-repeat;cursor:pointer;}
</style>
</head>
<body>

<!-- HUD -->
<div id="hud">
  <div>‡¶∏‡¶Æ‡¶Ø‡¶º: <span id="timer">90</span>s</div>
  <div>‡¶∞‡¶æ‡¶ó: <div style="width:100%;height:10px;background:#062022;border:1px solid #0ff;"><div id="moodBar" style="width:6%;height:100%;background:linear-gradient(to right,red,orange)"></div></div></div>
  <div>‡¶∏‡ßç‡¶ü‡ßá‡¶ú: <span id="stage">‡¶™‡ßç‡¶∞‡¶ø-‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡¶ø‡¶ï</span></div>
  <div>
    <button class="btn-small" onclick="saveGame()">üíæ ‡¶∏‡ßá‡¶≠</button>
    <button class="btn-small" onclick="loadGame()">üìÇ ‡¶≤‡ßã‡¶°</button>
    <button class="btn-small" onclick="resetGame()">‚ôªÔ∏è ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü</button>
    <button class="btn-small" onclick="toggleSound()">üîä ‡¶∏‡¶æ‡¶â‡¶®‡ßç‡¶°</button>
  </div>
  <div>
    <button class="btn-small" onclick="alert('Credits:\nDeveloped by AHSAN HABIB\nFB: https://www.facebook.com/ahm.habib.39')">üèÜ Credits</button>
  </div>
</div>

<!-- Overlay -->
<div id="overlay">
  <div id="overlayContent">
    <h2 id="overlayTitle">‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®</h2>
    <p id="overlayText">‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡¶õ, ‡¶π‡¶†‡¶æ‡ßé electricity ‡¶ö‡¶≤‡ßá ‡¶ó‡ßá‡¶≤! START ‡¶ö‡¶æ‡¶™‡ßÅ‡¶®‡•§</p>
    <button class="btn" onclick="startGame()">üéÆ START</button>
  </div>
</div>

<!-- Hint -->
<div id="hint">‡¶Æ‡¶æ‡¶â‡¶∏/‡¶Ü‡¶ô‡ßÅ‡¶≤ ‡¶®‡¶ø‡ßü‡ßá ‡¶ñ‡ßá‡¶≤‡ßÅ‡¶®</div>

<!-- Flashlight -->
<div id="flash"></div>

<!-- Particles -->
<canvas id="particles"></canvas>

<!-- Targets -->
<div id="fuse" class="target" style="left:50px;top:100px;width:100px;height:150px;background-image:url('assets/fuse_box.png');"></div>
<div id="cat" class="target hidden" style="left:150px;top:300px;width:120px;height:120px;background-image:url('assets/cat.png');"></div>
<div id="meter" class="target hidden" style="left:500px;top:200px;width:150px;height:150px;background-image:url('assets/meter_box.png');"></div>
<div id="pole" class="target hidden" style="left:400px;top:50px;width:120px;height:220px;background-image:url('assets/pole.png');"></div>

<script>
let step=0,mood=6,timer=90,running=false,soundsOn=true;
const flash=document.getElementById('flash');
const particles=document.getElementById('particles');
const ctx=particles.getContext('2d');
let particleStore=[];
let hintTimer=null;

// Audio
let ambient=new Audio('assets/ambient_loop.mp3');
ambient.loop=true;

function startGame(){
  document.getElementById('overlay').style.display='none';
  running=true;step=0;updateStage();
  if(soundsOn)ambient.play().catch(()=>{});
  let pre=4;showHint(`‡¶≤‡ßã‡¶°‡¶∂‡ßá‡¶°‡¶ø‡¶Ç ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶§‡ßá ‡¶Ü‡¶∞ ${pre} ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°`);
  const p=setInterval(()=>{
    pre--; if(pre>0)showHint(`‡¶≤‡ßã‡¶°‡¶∂‡ßá‡¶°‡¶ø‡¶Ç ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶§‡ßá ‡¶Ü‡¶∞ ${pre} ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°`);
    else{clearInterval(p);beginMission();}
  },1000);
}

function beginMission(){step=1;updateStage();showHint('‡¶≤‡ßã‡¶°‡¶∂‡ßá‡¶°‡¶ø‡¶Ç ‡¶π‡ßü‡ßá‡¶õ‡ßá ‚Äî ‡¶´‡¶ø‡¶â‡¶ú ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®!');document.getElementById('fuse').classList.remove('hidden');}

// Timer
setInterval(()=>{if(running){timer--;document.getElementById('timer').innerText=timer;if(timer<=0)endGame(false,'‡¶∏‡¶Æ‡ßü ‡¶∂‡ßá‡¶∑!');}},1000);

// Mood
setInterval(()=>{if(running){mood=Math.min(100,mood+2);document.getElementById('moodBar').style.width=mood+'%';if(mood>=90)endGame(false,'‡¶∞‡¶æ‡¶ó ‡¶¨‡ßá‡¶∂‡¶ø ‡¶π‡ßü‡ßá ‡¶ó‡ßá‡¶≤!');}},1500);

// Flashlight movement
document.addEventListener('mousemove',onMove);
document.addEventListener('touchmove',onMove);
function onMove(e){
  const x=e.touches?e.touches[0].clientX:e.clientX;
  const y=e.touches?e.touches[0].clientY:e.clientY;
  flash.style.background=`radial-gradient(circle 160px at ${x}px ${y}px, rgba(255,255,230,0.95), rgba(0,0,0,0) 40%), radial-gradient(circle 360px at ${x}px ${y}px, rgba(255,255,255,0.04), rgba(0,0,0,0.92) 60%)`;
}

// Hint
function showHint(t,ms=2500){document.getElementById('hint').innerText=t;if(hintTimer)clearTimeout(hintTimer);hintTimer=setTimeout(()=>{document.getElementById('hint').innerText='';},ms);}

// Click interactions
document.getElementById('fuse').onclick=function(e){if(step!==1)return;step=1.5;updateStage();document.getElementById('cat').classList.remove('hidden');spawnSparks(e.clientX,e.clientY,20);showHint('‡¶¨‡¶ø‡¶°‡¶º‡¶æ‡¶≤ ‡¶∏‡¶∞‡¶æ‡¶®');playClick();}
document.getElementById('cat').onclick=function(e){if(step!==1.5)return;step=2;updateStage();document.getElementById('cat').classList.add('hidden');document.getElementById('meter').classList.remove('hidden');spawnSparks(e.clientX,e.clientY,14);showHint('‡¶Æ‡¶ø‡¶ü‡¶æ‡¶∞ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®');playClick();}
document.getElementById('meter').onclick=function(e){if(step!==2)return;step=3;updateStage();document.getElementById('pole').classList.remove('hidden');showPhonePrompt();playClick();}
document.getElementById('pole').onclick=function(e){if(step!==3)return;step=4;updateStage();setTimeout(win,2500);playClick();}

// Win / End
function win(){running=false;ambient.pause();showHint('‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡ßÅ‡ßé ‡¶´‡¶ø‡¶∞‡ßá ‡¶è‡¶∏‡ßá‡¶õ‡ßá ‚Äî ‡¶ï‡¶æ‡¶ú ‡¶∂‡ßá‡¶∑ ‡¶π‡ßü‡ßá‡¶õ‡ßá!');}
function endGame(success,message){running=false;ambient.pause();alert(message);document.getElementById('overlay').style.display='flex';document.getElementById('overlayTitle').innerText=success?'‡¶¨‡¶ø‡¶ú‡¶Ø‡¶º!':'‡¶Æ‡¶ø‡¶∂‡¶® ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•!';document.getElementById('overlayText').innerText=message;}

// Sparks
function spawnSparks(x,y,n=12){for(let i=0;i<n;i++){particleStore.push({x,y,vx:(Math.random()-0.5)*3,vy:(Math.random()-1.8)*3,life:30+Math.random()*30,size:1+Math.random()*2,color:`rgba(255,${150+Math.floor(Math.random()*100)},0,1)`});}}
function tickParticles(){ctx.clearRect(0,0,particles.width,particles.height);for(let i=particleStore.length-1;i>=0;i--){const p=particleStore[i];p.x+=p.vx;p.y+=p.vy;p.vy+=0.06;p.life--;ctx.beginPath();ctx.globalAlpha=Math.max(0,p.life/60);ctx.fillStyle=p.color;ctx.arc(p.x,p.y,p.size,0,Math.PI*2);ctx.fill();if(p.life<=0)particleStore.splice(i,1);}requestAnimationFrame(tickParticles);}
tickParticles();

// Resize canvas
function resizeCanvas(){particles.width=window.innerWidth;particles.height=window.innerHeight;}
window.addEventListener('resize',resizeCanvas);
resizeCanvas();

// Audio helpers
function playClick(){if(!soundsOn)return;try{new Audio('assets/click.mp3').play().catch(()=>{});}catch(e){}}
function playError(){if(!soundsOn)return;try{new Audio('assets/error_buzz.mp3').play().catch(()=>{});}catch(e){}}

// Save / Load
function saveGame(){localStorage.setItem('ls_save',JSON.stringify({step,mood,timer,running}));showHint('‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá');}
function loadGame(){const raw=localStorage.getItem('ls_save');if(!raw){showHint('‡¶ï‡ßã‡¶®‡ßã ‡¶∏‡ßá‡¶≠ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü ‡¶®‡¶ø');return;}try{const s=JSON.parse(raw);step=s.step||0;mood=s.mood||6;timer=s.timer||90;running=s.running||false;updateStage();document.getElementById('timer').innerText=timer;document.getElementById('moodBar').style.width=mood+'%';showHint('‡¶∏‡ßá‡¶≠ ‡¶≤‡ßã‡¶° ‡¶π‡ßü‡ßá‡¶õ‡ßá');}catch(e){console.warn(e);showHint('‡¶≤‡ßã‡¶° ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ');}}
function resetGame(){if(confirm('‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶¨‡ßá‡¶®?')){localStorage.removeItem('ls_save');window.location.reload();}}
function toggleSound(){soundsOn=!soundsOn;if(!soundsOn)ambient.pause();else if(running)ambient.play().catch(()=>{});}

// Stage / HUD
function updateStage(){const stages=['‡¶™‡ßç‡¶∞‡¶ø-‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡¶ø‡¶ï','‡¶´‡¶ø‡¶â‡¶ú ‡¶ñ‡ßã‡¶Å‡¶ú‡¶æ','‡¶¨‡¶ø‡¶°‡¶º‡¶æ‡¶≤ ‡¶∏‡¶∞‡¶æ‡¶®','‡¶Æ‡¶ø‡¶ü‡¶æ‡¶∞ ‡¶ö‡ßá‡¶ï','‡¶ñ‡ßÅ‡¶Å‡¶ü‡¶ø ‡¶ö‡ßá‡¶ï','‡¶´‡¶æ‡¶á‡¶®‡¶æ‡¶≤'];document.getElementById('stage').innerText=stages[Math.floor(step)]||'‡¶Ö‡¶ú‡¶æ‡¶®‡¶æ';}

// Phone prompt
function showPhonePrompt(){const num=prompt('‡¶Ö‡¶´‡¶ø‡¶∏‡ßá ‡¶ï‡¶≤ ‡¶ï‡¶∞‡ßÅ‡¶® ‚Äî ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡ß© ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡ßü ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶® (‡¶ü‡¶ø‡¶™: 555)','');if(num==='555'){mood=Math.max(0,mood-8);showHint('‡¶ï‡¶≤ ‡¶π‡ßü‡ßá‡¶õ‡ßá ‚Äî ‡¶Æ‡¶æ‡¶†‡ßá ‡¶ó‡¶ø‡ßü‡ßá ‡¶´‡¶ø‡¶â‡¶ú ‡¶Ü‡¶®‡ßÅ‡¶®');}else{mood=Math.min(100,mood+12);showHint('‡¶≠‡ßÅ‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‚Äî ‡¶∞‡¶æ‡¶ó ‡¶¨‡ßá‡ßú‡ßá ‡¶ó‡ßá‡¶≤');playError();}document.getElementById('moodBar').style.width=mood+'%';}
</script>
</body>
</html>
