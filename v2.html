<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>‡¶≤‡ßã‡¶°‡¶∂‡ßá‡¶°‡¶ø‡¶Ç ‡¶∞‡¶ø‡¶ï‡¶≠‡¶æ‡¶∞‡¶ø - Ultra Mobile Friendly</title>
<style>
  body, html { margin:0; padding:0; height:100%; font-family:sans-serif; background:#071126; overflow:hidden; }
  .container { display:flex; flex-direction:row; height:100%; width:100%; }
  .sidebar { width:250px; background:rgba(0,0,0,0.3); border-right:2px solid #0ff; padding:10px; box-sizing:border-box; display:flex; flex-direction:column; gap:10px; flex-shrink:0; }
  .sidebar button { padding:12px; border:none; border-radius:8px; cursor:pointer; font-weight:bold; background:#0ff; color:#000; transition:0.2s; font-size:16px; }
  .sidebar button:hover { transform:scale(1.05); box-shadow:0 0 15px #0ff; }
  .game-area { flex:1; position:relative; overflow:hidden; touch-action:none; }
  .target { position:absolute; background-size:contain; background-repeat:no-repeat; cursor:pointer; transition: transform 0.3s, opacity 0.5s; }
  #fuse { width:100px; height:150px; left:5%; top:20%; background-image:url('assets/fuse_box.png'); }
  #cat { width:100px; height:100px; left:35%; top:35%; background-image:url('assets/cat.png'); opacity:0; }
  #meter { width:120px; height:120px; left:65%; top:55%; background-image:url('assets/meter_box.png'); opacity:0; }
  #pole { width:100px; height:180px; left:45%; top:10%; background-image:url('assets/pole.png'); opacity:0; }
  #flash { position:absolute; inset:0; z-index:30; pointer-events:auto; transition: background 0.1s; }
  canvas { position:absolute; inset:0; z-index:20; pointer-events:none; }
  .hint { position:absolute; bottom:15px; left:50%; transform:translateX(-50%); background:rgba(0,0,0,0.5); color:#0ff; padding:8px 16px; border-radius:20px; font-size:14px; border:1px solid #0ff; z-index:40; }
  .overlay { position:absolute; inset:0; background:rgba(0,0,0,0.85); display:flex; justify-content:center; align-items:center; z-index:50; }
  .overlay-box { background:linear-gradient(to bottom,#00131a,#001b22); padding:20px; border-radius:16px; text-align:center; border:2px solid #0ff; max-width:400px; }
  .overlay-box h2 { color:#0ff; font-size:24px; margin-bottom:10px; }
  .overlay-box p { color:#fff; margin-bottom:15px; font-size:16px; }
  .overlay-box button { margin:5px; padding:10px 15px; border:none; border-radius:6px; cursor:pointer; font-weight:bold; background:#0ff; color:#000; transition:0.2s; font-size:16px; }
  .overlay-box button:hover { transform:scale(1.05); box-shadow:0 0 15px #0ff; }
  @media(max-width:768px){
    .container { flex-direction:column; }
    .sidebar { width:100%; flex-direction:row; flex-wrap:wrap; justify-content:center; border-right:none; border-bottom:2px solid #0ff; }
    .sidebar button { flex:1 1 45%; margin:4px; }
  }
</style>
</head>
<body>
<div class="container">
  <!-- Sidebar -->
  <div class="sidebar">
    <button id="startBtn">üéÆ START</button>
    <button id="saveBtn">üíæ ‡¶∏‡ßá‡¶≠</button>
    <button id="loadBtn">üìÇ ‡¶≤‡ßã‡¶°</button>
    <button id="resetBtn">‚ôªÔ∏è ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü</button>
    <button id="soundBtn">üîä ‡¶∏‡¶æ‡¶â‡¶®‡ßç‡¶° ON</button>
    <button id="creditsBtn">‚ú® Developed by AHSAN HABIB</button>
  </div>

  <!-- Game Area -->
  <div class="game-area" id="gameArea">
    <div id="fuse" class="target"></div>
    <div id="cat" class="target"></div>
    <div id="meter" class="target"></div>
    <div id="pole" class="target"></div>
    <canvas id="particles"></canvas>
    <div id="flash"></div>
    <div class="hint" id="hint">‡¶Æ‡¶æ‡¶â‡¶∏/‡¶Ü‡¶ô‡ßÅ‡¶≤ ‡¶¶‡ßç‡¶¨‡¶æ‡¶∞‡¶æ ‡¶´‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶∂‡¶≤‡¶æ‡¶á‡¶ü ‡¶®‡¶ø‡ßü‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®</div>
  </div>
</div>

<!-- Overlay -->
<div class="overlay" id="overlay">
  <div class="overlay-box">
    <h2>‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®</h2>
    <p>‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡¶õ‡¶ø‡¶≤‡ßá, ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶π‡¶†‡¶æ‡ßé ‡¶ï‡¶∞‡ßá electricity ‡¶ö‡¶≤‡ßá ‡¶ó‡ßá‡¶õ‡ßá! ‡¶ï‡¶æ‡¶ú ‡¶∂‡ßá‡¶∑ ‡¶ï‡¶∞‡¶§‡ßá START ‡¶ö‡¶æ‡¶™‡ßÅ‡¶®‡•§</p>
    <button id="overlayStart">üéÆ START</button>
  </div>
</div>

<script>
const startBtn = document.getElementById('startBtn');
const saveBtn = document.getElementById('saveBtn');
const loadBtn = document.getElementById('loadBtn');
const resetBtn = document.getElementById('resetBtn');
const soundBtn = document.getElementById('soundBtn');
const creditsBtn = document.getElementById('creditsBtn');
const overlay = document.getElementById('overlay');
const overlayStart = document.getElementById('overlayStart');
const hint = document.getElementById('hint');
const gameArea = document.getElementById('gameArea');
const flash = document.getElementById('flash');
const particlesCanvas = document.getElementById('particles');
const ctx = particlesCanvas.getContext('2d');

let raf;
let soundsOn = true, running = false;
let mood = 6, timer=90, step=0;
let found = { fuse:false, cat:false, meter:false, pole:false };
let particleStore = [];
let ambient = new Audio('assets/mission_loop.mp3'); ambient.loop=true;

// resize canvas
function resizeCanvas(){ particlesCanvas.width=gameArea.clientWidth; particlesCanvas.height=gameArea.clientHeight; }
window.addEventListener('resize',resizeCanvas); resizeCanvas();

// flashlight follow (mouse + touch)
function updateFlash(x,y){
  flash.style.background=`radial-gradient(circle 160px at ${x}px ${y}px, rgba(255,255,230,0.95), rgba(0,0,0,0) 40%), radial-gradient(circle 360px at ${x}px ${y}px, rgba(255,255,255,0.04), rgba(0,0,0,0.92) 60%)`;
}
gameArea.addEventListener('mousemove',(e)=>{ updateFlash(e.offsetX,e.offsetY); });
gameArea.addEventListener('touchmove',(e)=>{ e.preventDefault(); const t=e.touches[0]; const rect=gameArea.getBoundingClientRect(); updateFlash(t.clientX-rect.left,t.clientY-rect.top); },{passive:false});

// particles
function spawnSparks(x,y,n=12){
  for(let i=0;i<n;i++){
    particleStore.push({x,y,vx:(Math.random()-0.5)*3,vy:(Math.random()-1.8)*3,life:30+Math.random()*30,size:1+Math.random()*2,color:`rgba(255,${150+Math.floor(Math.random()*100)},0,1)`});
  }
}
function tickParticles(){
  ctx.clearRect(0,0,particlesCanvas.width,particlesCanvas.height);
  for(let i=particleStore.length-1;i>=0;i--){
    const p=particleStore[i];
    p.x+=p.vx; p.y+=p.vy; p.vy+=0.06; p.life--;
    ctx.beginPath(); ctx.globalAlpha=Math.max(0,p.life/60); ctx.fillStyle=p.color;
    ctx.arc(p.x,p.y,p.size,0,Math.PI*2); ctx.fill();
    if(p.life<=0) particleStore.splice(i,1);
  }
  raf=requestAnimationFrame(tickParticles);
}
tickParticles();

// hint
function typeHint(t,ms=2500){ hint.textContent=t; setTimeout(()=>{ hint.textContent='‡¶Æ‡¶æ‡¶â‡¶∏/‡¶Ü‡¶ô‡ßÅ‡¶≤ ‡¶¶‡ßç‡¶¨‡¶æ‡¶∞‡¶æ ‡¶´‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶∂‡¶≤‡¶æ‡¶á‡¶ü ‡¶®‡¶ø‡ßü‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®'; },ms); }

// button actions
function startGame(){ overlay.style.display='none'; running=true; step=1; typeHint('‡¶≤‡ßã‡¶°‡¶∂‡ßá‡¶°‡¶ø‡¶Ç ‡¶π‡ßü‡ßá‡¶õ‡ßá ‚Äî ‡¶´‡¶ø‡¶â‡¶ú ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®!'); if(soundsOn) ambient.play().catch(()=>{}); fadeInTargets(); }
function saveGame(){ localStorage.setItem('ls_save',JSON.stringify({step,mood,timer,found})); typeHint('‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá'); }
function loadGame(){ const raw=localStorage.getItem('ls_save'); if(!raw){typeHint('‡¶ï‡ßã‡¶®‡ßã ‡¶∏‡ßá‡¶≠ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø'); return;} const s=JSON.parse(raw); step=s.step||0; mood=s.mood||0; timer=s.timer||90; found=s.found||found; typeHint('‡¶∏‡ßá‡¶≠ ‡¶≤‡ßã‡¶° ‡¶π‡ßü‡ßá‡¶õ‡ßá'); fadeInTargets(); }
function resetGame(){ if(confirm('‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶¨‡ßá‡¶®?')){ localStorage.removeItem('ls_save'); window.location.reload(); } }
function toggleSound(){ soundsOn=!soundsOn; soundBtn.textContent = soundsOn?'üîä ‡¶∏‡¶æ‡¶â‡¶®‡ßç‡¶° ON':'üîá ‡¶∏‡¶æ‡¶â‡¶®‡ßç‡¶° OFF'; if(soundsOn) ambient.play().catch(()=>{}); else ambient.pause(); }
function openCredits(){ window.open('https://www.facebook.com/ahm.habib.39','_blank'); }

// fade-in targets
function fadeInTargets(){
  document.getElementById('cat').style.transition='opacity 0.8s';
  document.getElementById('meter').style.transition='opacity 0.8s';
  document.getElementById('pole').style.transition='opacity 0.8s';
  document.getElementById('cat').style.opacity=step>=1.5?1:0;
  document.getElementById('meter').style.opacity=step>=2?1:0;
  document.getElementById('pole').style.opacity=step>=3?1:0;
}

startBtn.addEventListener('click',startGame);
overlayStart.addEventListener('click',startGame);
saveBtn.addEventListener('click',saveGame);
loadBtn.addEventListener('click',loadGame);
resetBtn.addEventListener('click',resetGame);
soundBtn.addEventListener('click',toggleSound);
creditsBtn.addEventListener('click',openCredits);

// target interactions
function clickTarget(id,nextStep,hintText,sparks){
  const el=document.getElementById(id);
  el.addEventListener('click',(e)=>{
    if(step!==nextStep-1) return;
    spawnSparks(e.clientX,e.clientY,sparks);
    found[id]=true; step=nextStep; typeHint(hintText); fadeInTargets();
  });
  el.addEventListener('touchstart',(e)=>{
    if(step!==nextStep-1) return;
    const t=e.touches[0]; const rect=el.getBoundingClientRect();
    spawnSparks(t.clientX,t.clientY,sparks);
    found[id]=true; step=nextStep; typeHint(hintText); fadeInTargets();
    e.preventDefault();
  },{passive:false});
}

clickTarget('fuse',1.5,'‡¶´‡¶ø‡¶â‡¶ú ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶ó‡ßá‡¶õ‡ßá ‚Äî ‡¶¨‡¶ø‡¶°‡¶º‡¶æ‡¶≤ ‡¶∏‡¶∞‡¶æ‡¶®',20);
clickTarget('cat',2,'‡¶¨‡¶ø‡¶°‡¶º‡¶æ‡¶≤ ‡¶∏‡¶∞‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá ‚Äî ‡¶Æ‡¶ø‡¶ü‡¶æ‡¶∞ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®',15);
clickTarget('meter',3,'‡¶Æ‡¶ø‡¶ü‡¶æ‡¶∞ ‡¶ö‡ßá‡¶ï ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‚Äî ‡¶ñ‡ßÅ‡¶Å‡¶ü‡¶ø ‡¶§‡ßá ‡¶Ø‡¶æ‡¶®',15);
clickTarget('pole',4,'‡¶´‡¶æ‡¶á‡¶®‡¶æ‡¶≤ ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‚Äî ‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡ßÅ‡ßé ‡¶´‡¶ø‡¶∞‡ßá ‡¶è‡¶∏‡ßá‡¶õ‡ßá!',20);
</script>
</body>
</html>
